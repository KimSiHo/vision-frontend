#!/bin/bash

# ÏàòÏ†ï/Ï∂îÍ∞ÄÎêú C/C++ ÌååÏùºÎßå Ï∂îÏ∂ú
files=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(cpp|cc|c|hpp|h)$')

[ -z "$files" ] && exit 0

echo "üîç Running clang-format check..."

unformatted=$(clang-format --dry-run --Werror $files 2>&1)

if [ $? -ne 0 ]; then
  echo "‚ùå Some files are not formatted properly:"
  echo "$unformatted"
  echo
  echo "‚û°  Run 'clang-format -i <file>' or 'git clang-format' to fix formatting."
  exit 1
fi

echo "‚úÖ All files are properly formatted."
